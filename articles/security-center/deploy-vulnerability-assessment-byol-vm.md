---
title: Evaluación de vulnerabilidades de máquina virtual BYOL en Azure Security Center
description: Implemente una solución de evaluación de vulnerabilidades BYOL en Azure Virtual Machines para obtener recomendaciones de Azure Security Center que le ayuden a proteger las máquinas virtuales.
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/20/2020
ms.author: memildin
ms.openlocfilehash: 8e17f58b122a9db3e1a2d1aa5d9b3db2b657ba3b
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/22/2020
ms.locfileid: "90906431"
---
# <a name="deploy-a-bring-your-own-license-byol-vulnerability-assessment-solution"></a>Implemente una solución de evaluación de vulnerabilidades BYOL (traiga su propia licencia)

Si habilitó **Azure Defender para servidores**, puede usar la herramienta de evaluación de vulnerabilidades integrada de Azure Security Center, tal y como se describe en [Detector de vulnerabilidades integrado para máquinas virtuales](built-in-vulnerability-assessment.md). Esta herramienta se integra en Azure Defender y no requiere ninguna licencia externa, todo se controla sin problemas en Security Center.

Como alternativa, es posible que quiera implementar su propia solución de evaluación de vulnerabilidades con licencia privada de [Qualys](https://www.qualys.com/lp/azure) o [Rapid7](https://www.rapid7.com/products/insightvm/). Puede instalar una de estas soluciones de asociados en varias máquinas virtuales que pertenezcan a la misma suscripción.

## <a name="deploy-a-byol-solution-from-the-azure-portal"></a>Implementación de una solución BYOL desde Azure Portal

Las opciones BYOL hacen referencia a soluciones de evaluación de vulnerabilidades de terceros compatibles. Actualmente se admiten los proveedores de Qualys y Rapid7.

Las soluciones compatibles notifican los datos de vulnerabilidades a la plataforma de administración del asociado. A su vez, esa plataforma proporciona datos de supervisión del estado y las vulnerabilidades a Security Center. Puede identificar las máquinas virtuales vulnerables desde el panel de Security Center y conmutar a la consola de administración de socios comerciales directamente desde Security Center para más información e informes.

1. En [Azure Portal](https://azure.microsoft.com/features/azure-portal/), abra **Security Center**.

1. En el menú de Security Center, abra la página **Recomendaciones**.

1. Seleccione la recomendación **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Las agrupaciones de las máquinas en la página de la recomendación **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    Las máquinas virtuales aparecerán en uno o varios de los siguientes grupos:

    * **Recursos correctos**: Security Center ha detectado una solución de evaluación de vulnerabilidades que se ejecuta en estas máquinas virtuales.
    * **Recursos incorrectos**: la extensión del detector de vulnerabilidades se puede implementar en estas máquinas virtuales. 
    * **Recursos no aplicables**: no se puede implementar la extensión del detector de vulnerabilidades en estas máquinas virtuales.

1. En la lista de máquinas incorrectas, seleccione las que recibirán una solución de evaluación de vulnerabilidades y seleccione **Corregir**.

    >[!IMPORTANT]
    > En función de la configuración, es posible que solo vea un subconjunto de esta lista. 
    >
    > - Si no tiene un detector de vulnerabilidades de terceros configurado, no se le ofrecerá la oportunidad de implementarlo.
    > - Si las máquinas virtuales seleccionadas no están protegidas con Azure Defender, la opción de detector de vulnerabilidades integrado de ASC no estará disponible.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="Las opciones para el tipo de flujo de corrección que quiere elegir al responder a la recomendación de la página **La solución de evaluación de vulnerabilidades debe estar habilitada en sus máquinas virtuales**":::

1. Si está estableciendo una nueva configuración de BYOL, seleccione **Configure a new third-party vulnerability scanner** (Configurar un nuevo detector de vulnerabilidades de terceros), seleccione **Continuar** y escriba los detalles del proveedor de la siguiente manera:

    1. En **Grupo de recursos**, seleccione **Usar existente**.
    1. En **Ubicación**, seleccione el lugar en el que la solución se encuentra geográficamente localizada.
    1. Para Qualys, escriba la licencia proporcionada por Qualys en el campo **Código de licencia**.
    1. Para Rapid7, cargue el **archivo de configuración de Rapid7**.
    1. En el cuadro **Clave pública**, escriba la información de la clave pública que proporciona el asociado.
    1. Para instalar automáticamente un agente de evaluación de vulnerabilidades en todas las VM detectadas en la suscripción de esta solución Qualys, seleccione **Implementación automática**.
    1. Seleccione **Aceptar**.

1. Si ya ha configurado la solución BYOL, seleccione **Deploy your configured third-party vulnerability scanner** (Implementar el detector de vulnerabilidades de terceros configurado) y **Continuar**.

Una vez instalada la solución de evaluación de vulnerabilidades en las máquinas de destino, Security Center realiza un análisis para detectar e identificar las vulnerabilidades en el sistema y en la aplicación. El primer examen puede tardar un par de horas en completarse. Después, se ejecuta cada hora.



## <a name="deploy-a-byol-solution-using-powershell-and-the-rest-api"></a>Implementación de una solución BYOL mediante PowerShell y la API REST

Para implementar mediante programación su propia solución de valoración de vulnerabilidades con licencia privada desde [Qualys](https://www.qualys.com/lp/azure) o [Rapid7](https://www.rapid7.com/products/insightvm/), use el script proporcionado [PowerShell > Solución de vulnerabilidad](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution). Este script usa la API de REST para crear una nueva solución de seguridad en ASC. Necesitará una licencia y una clave que proporciona el proveedor de servicios (Qualys o Rapid7).

> [!IMPORTANT] 
> Solo se puede crear una solución por licencia. Se producirá un error al intentar crear otra solución con el mismo nombre, licencia o clave.

### <a name="prerequisites"></a>Prerrequisitos

Módulos de PowerShell necesarios:

- Install-module Az
- Install-module Az.security

### <a name="run-the-script"></a>Ejecute el script.

Para ejecutar el script, necesitará la información pertinente para los parámetros siguientes.

| **Parámetro** | **Obligatorio** | **Notas** |
|----|:----:|----|
|**SubscriptionId**|✔|Valor de subscriptionID de la suscripción de Azure que contiene los recursos que quiere analizar.|
|**ResourceGroupName**|✔|Nombre del grupo de recursos. Use cualquier grupo de recursos existente que incluya el valor predeterminado ("DefaultResourceGroup-xxx"). Dado que la solución no es un recurso de Azure, no aparecerá en el grupo de recursos, pero está conectada a este.|
|**vaSolutionName**|✔|Nombre de la nueva solución.|
|**vaType**|✔|Qualys o Rapid7.|
|**licenceCode**|✔|Cadena de licencia proporcionada por el proveedor.|
|**publicKey**|✔|Clave pública proporcionada por el proveedor.|
|**autoUpdate**|-|Habilite (true) o deshabilite (false) la implementación automática para esta solución de VA. Cuando está habilitada, todas las VM nuevas de la suscripción intentarán vincularse automáticamente a la solución.<br/>(Valor predeterminado: False)|
||||

Sintaxis:

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenceCode <License code from vendor> -publicKey <Public Key received from vendor>
```

Ejemplo (en este ejemplo no se incluyen detalles de licencia válidos):

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```

## <a name="next-steps"></a>Pasos siguientes

> [!div class="nextstepaction"]
> [Corrección de los resultados de las soluciones de evaluación de vulnerabilidades](remediate-vulnerability-findings-vm.md)


Security Center también ofrece análisis de vulnerabilidades para:

- SQL Database: consulte [Exploración de los informes de evaluación de vulnerabilidades en el panel de evaluación de vulnerabilidades](defender-for-sql-usage.md#explore-vulnerability-assessment-reports).
- Imágenes de Azure Container Registry: consulte [Integración de Azure Container Registry con Security Center](azure-container-registry-integration.md).